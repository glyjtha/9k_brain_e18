```{r}
library(Seurat)
library(slingshot)
```

```{r}
data_dir <- "scripps_hpc_rstudio/gloria_r_folder/9k_brain_e18"

library(ggplot2)

# Load into Seurat
matrix_data <- Read10X(data.dir = "scripps_hpc_rstudio/gloria_r_folder/9k_brain_e18/filtered_gene_bc_matrices/mm10" )
seurat_obj <- CreateSeuratObject(counts = matrix_data, project = "NeuronE18", min.cells = 3, min.features = 200)
```

```{r}
seurat_obj[["RNA"]]@counts         # raw counts
seurat_obj[["RNA"]]@data           # normalized (after NormalizeData())
seurat_obj[["RNA"]]@scale.data     # scaled (after ScaleData())
```


```{r}
head(seurat_obj@meta.data)

```
```{r}
Idents(seurat_obj) <- "seurat_clusters"
```

```{r}
seurat_obj <- NormalizeData(seurat_obj)
seurat_obj <- FindVariableFeatures(seurat_obj)
seurat_obj <- ScaleData(seurat_obj)
seurat_obj <- RunPCA(seurat_obj)
```
```{r}
seurat_obj <- FindNeighbors(seurat_obj, dims = 1:10)
seurat_obj <- FindClusters(seurat_obj, resolution = 0.5)
seurat_obj <- RunUMAP(seurat_obj, dims = 1:10)
```

```{r}
DimPlot(seurat_obj, reduction = "umap", label = TRUE)

```

```{r}
seurat_obj <- subset(seurat_obj, subset = nFeature_RNA > 200 & nCount_RNA < 7500)
```

```{r}
markers <- FindAllMarkers(seurat_obj, only.pos = TRUE, min.pct = 0.25)
markers

```

```{r}
head(markers)

```

